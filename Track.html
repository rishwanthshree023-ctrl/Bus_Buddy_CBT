<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>🚌 LIVE BUS LOCATION – Bus Buddy</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
  :root {
    --bg1: #0b1023; --bg2: #0e1b4f;
    --ac1: #3ee7ff; --ac2: #7a7dff; --ac3: #21f1a5;
    --text: #e9f0ff; --muted: #9db1ff;
  }
  * { box-sizing: border-box; margin:0; padding:0; }
  body { font-family: 'Poppins', sans-serif; background: linear-gradient(145deg, var(--bg1), var(--bg2)); color: var(--text); height:100vh; display:flex; flex-direction:column; }
  
  h1 { font-family:'Orbitron', monospace; margin:16px; font-size:28px; display:flex; align-items:center; gap:10px; }
  .container { flex:1; display:flex; padding:10px; gap:12px; }

  #map { flex:3; min-height:400px; border-radius:18px; border:1px solid rgba(255,255,255,0.2); }

  .sidebar { flex:1; background: rgba(0,0,0,0.4); border-radius:16px; padding:20px; display:flex; flex-direction:column; justify-content:space-between; }

  .info-box { background: rgba(0,0,0,0.6); padding:16px; border-radius:14px; color:#fff; margin-bottom:12px; font-weight:700; text-align:center; font-size:16px; 
              box-shadow:0 6px 12px rgba(0,0,0,0.5); border: 1px solid #3ee7ff; transition: 0.3s; }
  .info-box span { color:#3ee7ff; font-weight:800; }

  .route-select { width:100%; padding:12px; border-radius:12px; border:none; background: rgba(255,255,255,0.1); color:#fff; margin-bottom:16px; font-size:15px; }
  .route-select option { background:#0b1023; color:#fff; }

  .logout-btn { padding:16px 22px; border:none; border-radius:12px; font-weight:700; font-size:17px; cursor:pointer; background: linear-gradient(135deg, var(--ac2), var(--ac1)); color:#081126; box-shadow:0 8px 20px rgba(62,231,255,.3); transition: transform .2s; }
  .logout-btn:hover { transform: scale(1.05); }
</style>
</head>
<body>

<h1>🚌 LIVE BUS LOCATION</h1>

<div class="container">
  <div id="map"></div>
  <div class="sidebar">
    <div>
      <select id="routeSelect" class="route-select">
        <option value="">Select Route</option>
        <option value="route1">Route 1</option>
        <option value="route2">Route 2</option>
        <option value="route3">Route 3</option>
        <option value="route4">Route 4</option>
        <option value="route5">Route 5</option>
        <option value="route6">Route 6</option>
        <option value="route7">Route 7</option>
        <option value="route8">Route 8</option>
        <option value="route9">Route 9</option>
        <option value="route10">Route 10</option>
        <option value="route11">Route 11</option>
        <option value="route12">Route 12</option>
      </select>
      <div class="info-box" id="etaBox">Estimated Arrival: <span>-- min</span></div>
      <div class="info-box" id="nextStop">Next Stop: <span>--</span></div>
    </div>
    <button class="logout-btn" onclick="logout()">Logout</button>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
  const map = L.map('map').setView([9.9252, 78.1198], 13);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(map);

  const routes = {
    route1: [[9.9252, 78.1198],[9.9300, 78.1200],[9.9350, 78.1250],[9.9400, 78.1300]],
    route2: [[9.9252, 78.1198],[9.9200, 78.1150],[9.9150, 78.1100],[9.9100, 78.1050]],
    route3: [[9.9252,78.1198],[9.9270,78.1220],[9.9290,78.1250],[9.9320,78.1270]],
    route4: [[9.9252,78.1198],[9.9280,78.1180],[9.9300,78.1160],[9.9350,78.1150]],
    route5: [[9.9252,78.1198],[9.9260,78.1210],[9.9280,78.1230],[9.9310,78.1240]],
    route6: [[9.9252,78.1198],[9.9220,78.1200],[9.9200,78.1220],[9.9180,78.1240]],
    route7: [[9.9252,78.1198],[9.9270,78.1170],[9.9300,78.1150],[9.9330,78.1130]],
    route8: [[9.9252,78.1198],[9.9265,78.1165],[9.9285,78.1145],[9.9310,78.1120]],
    route9: [[9.9252,78.1198],[9.9235,78.1215],[9.9215,78.1235],[9.9200,78.1250]],
    route10:[[9.9252,78.1198],[9.9280,78.1200],[9.9300,78.1220],[9.9330,78.1240]],
    route11:[[9.9252,78.1198],[9.9260,78.1180],[9.9280,78.1160],[9.9310,78.1150]],
    route12:[[9.9252,78.1198],[9.9270,78.1210],[9.9290,78.1230],[9.9320,78.1250]]
  };

  let routeLine, busMarker, busIcon, stopMarkers = [];

  busIcon = L.icon({
    iconUrl: 'https://cdn-icons-png.flaticon.com/512/61/61231.png',
    iconSize: [32,32],
    iconAnchor: [16,16]
  });

  // 📍 Emoji Marker Icon
  const stopIcon = L.divIcon({
    html: "📍",
    className: "stop-icon",
    iconSize: [20,20],
    iconAnchor: [10,10]
  });

  function showRoute(routeName){
    if(routeLine){ map.removeLayer(routeLine); }
    if(busMarker){ map.removeLayer(busMarker); }
    stopMarkers.forEach(m => map.removeLayer(m));
    stopMarkers = [];

    if(!routeName) return;

    const latlngs = routes[routeName];
    routeLine = L.polyline(latlngs, {color: 'lime', weight:6}).addTo(map);
    map.fitBounds(routeLine.getBounds());

    // 📍 Add emoji stop markers
    latlngs.forEach((point, i)=>{
      const marker = L.marker(point, {icon: stopIcon}).bindPopup(`Stop ${i+1}`).addTo(map);
      stopMarkers.push(marker);
    });

    busMarker = L.marker(latlngs[0], {icon: busIcon}).addTo(map);

    let index = 0;
    setInterval(()=>{
      index++;
      if(index >= latlngs.length){ index=0; }
      busMarker.setLatLng(latlngs[index]);
      document.getElementById('etaBox').innerHTML = `Estimated Arrival: <span>${10 - index*2} min</span>`;
      document.getElementById('nextStop').innerHTML = `Next Stop: <span>Stop ${index+1}</span>`;
    }, 2000);
  }

  document.getElementById('routeSelect').addEventListener('change', (e)=> showRoute(e.target.value));

  function logout(){ window.location.href="login.html"; }
</script>

</body>
</html>
